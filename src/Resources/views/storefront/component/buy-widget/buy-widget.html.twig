{% sw_extends '@Storefront/storefront/component/buy-widget/buy-widget.html.twig' %}

{% block buy_widget %}
    {{ parent() }}

    {% if page.getExtension('klaviyoIntegrationPluginExtension').configuration.trackSubscribedToBackInStock and
        page.extensions.klaviyoIntegrationPluginExtension.backInStockData and not product.translated.customFields.klaviyo_back_in_stock_disabled %}
        {% set publicApiKey = page.getExtension('klaviyoIntegrationPluginExtension').configuration.publicApiKey %}

        {% set extensionData = page.getExtension('klaviyoIntegrationPluginExtension') %}
        {% sw_include '@Storefront/storefront/page/product-detail/back-in-stock-form.html.twig' with {extensionData: extensionData} %}
    {% endif %}
{% endblock %}
