!function(n){var t={};function e(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return n[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}e.m=n,e.c=t,e.d=function(n,t,i){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:i})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var r in n)e.d(i,r,function(t){return n[t]}.bind(null,r));return i},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="/bundles/administration/",e(e.s="cmNQ")}({"3FV1":function(n){n.exports=JSON.parse('{"klaviyo_integration_plugin":{"not_available":"N/A","subscribers":{"last_synchronization_status":{"finished":"Last Synchronization: {status} ({date})","not_finished":"Last Synchronization: {status}"},"last_success_synchronization":"Last Success Synchronization: {date}","get_synchronization_status":{"failed":"Failed to get Last Subscribers synchronization status"},"schedule_synchronization":{"button_label":"Synchronize subscribers","success":"Subscribers synchronization scheduled","failed":"Subscribers synchronization failed to schedule","is_running":"Subscribers synchronization is already running","is_scheduled":"Subscribers synchronization is already scheduled"}},"historical_events_tracking":{"last_synchronization_status":{"finished":"Last Synchronization: {status} ({date})","not_finished":"Last Synchronization: {status}"},"last_success_synchronization":"Last Success Synchronization: {date}","get_synchronization_status":{"failed":"Failed to get Last Historical Events Tracking synchronization status"},"schedule_synchronization":{"button_label":"Synchronize historical events","success":"Historical events synchronization scheduled","failed":"Historical events synchronization failed to schedule","is_running":"Historical events synchronization is already running","is_scheduled":"Historical events synchronization is already scheduled"}},"promotion":{"exportInKlaviyoFormatButtonLabel":"Export in Klaviyo Format"},"productComparison":{"templates":{"template-label":{"klaviyo-product-feed":"Klaviyo (XML)"}}}}}')},"EU/g":function(n,t){n.exports="</Products>\n</rss>\n"},SZ7m:function(n,t,e){"use strict";function i(n,t){for(var e=[],i={},r=0;r<t.length;r++){var o=t[r],s=o[0],a={id:n+":"+r,css:o[1],media:o[2],sourceMap:o[3]};i[s]?i[s].parts.push(a):e.push(i[s]={id:s,parts:[a]})}return e}e.r(t),e.d(t,"default",(function(){return y}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var o={},s=r&&(document.head||document.getElementsByTagName("head")[0]),a=null,c=0,l=!1,u=function(){},h=null,d="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function y(n,t,e,r){l=e,h=r||{};var s=i(n,t);return f(s),function(t){for(var e=[],r=0;r<s.length;r++){var a=s[r];(c=o[a.id]).refs--,e.push(c)}t?f(s=i(n,t)):s=[];for(r=0;r<e.length;r++){var c;if(0===(c=e[r]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete o[c.id]}}}}function f(n){for(var t=0;t<n.length;t++){var e=n[t],i=o[e.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](e.parts[r]);for(;r<e.parts.length;r++)i.parts.push(g(e.parts[r]));i.parts.length>e.parts.length&&(i.parts.length=e.parts.length)}else{var s=[];for(r=0;r<e.parts.length;r++)s.push(g(e.parts[r]));o[e.id]={id:e.id,refs:1,parts:s}}}}function v(){var n=document.createElement("style");return n.type="text/css",s.appendChild(n),n}function g(n){var t,e,i=document.querySelector("style["+d+'~="'+n.id+'"]');if(i){if(l)return u;i.parentNode.removeChild(i)}if(p){var r=c++;i=a||(a=v()),t=_.bind(null,i,r,!1),e=_.bind(null,i,r,!0)}else i=v(),t=m.bind(null,i),e=function(){i.parentNode.removeChild(i)};return t(n),function(i){if(i){if(i.css===n.css&&i.media===n.media&&i.sourceMap===n.sourceMap)return;t(n=i)}else e()}}var b,S=(b=[],function(n,t){return b[n]=t,b.filter(Boolean).join("\n")});function _(n,t,e,i){var r=e?"":i.css;if(n.styleSheet)n.styleSheet.cssText=S(t,r);else{var o=document.createTextNode(r),s=n.childNodes;s[t]&&n.removeChild(s[t]),s.length?n.insertBefore(o,s[t]):n.appendChild(o)}}function m(n,t){var e=t.css,i=t.media,r=t.sourceMap;if(i&&n.setAttribute("media",i),h.ssrId&&n.setAttribute(d,t.id),r&&(e+="\n/*# sourceURL="+r.sources[0]+" */",e+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},UrNF:function(n,t,e){},cmNQ:function(n,t,e){"use strict";e.r(t);var i=e("pIgR"),r=e.n(i);Shopware.Component.override("sw-system-config",{template:r.a});var o=e("3FV1"),s=e("jumV"),a=e.n(s);e("ka2J");function c(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var l=function(){function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.apiService=t,this.isSynchronizationInProgress=!1,this.isSynchronizationSuccess=!1,this.date=e}var t,e,i;return t=n,(e=[{key:"scheduleSynchronization",value:function(){var n=this.apiService.scheduleSynchronization();return this.isSynchronizationInProgress=!0,n.then(function(n){this.isSynchronizationSuccess=!!n.data.isScheduled}.bind(this)).catch(function(n){this.isSynchronizationSuccess=!1}.bind(this)).finally(function(){this.isSynchronizationInProgress=!1}.bind(this)),n}},{key:"resetSynchronizationState",value:function(){this.isSynchronizationInProgress=!1,this.isSynchronizationSuccess=!1}}])&&c(t.prototype,e),i&&c(t,i),n}(),u=Shopware,h=u.Component,d=u.Mixin,p=Shopware.Utils.format.date;h.register("klaviyo-historical-events-synchronization-control",{template:a.a,inject:["klaviyoHistoricalEventsSynchronizationApiService","klaviyoSubscribersSynchronizationApiService"],snippets:{"en-GB":o},mixins:[d.getByName("notification")],data:function(){return{historicalEventsJobInteractor:new l(this.klaviyoHistoricalEventsSynchronizationApiService,p),subscribersSynchronizationJobInteractor:new l(this.klaviyoSubscribersSynchronizationApiService,p)}},methods:{scheduleHistoricalEventsSynchronization:function(){this.historicalEventsJobInteractor.scheduleSynchronization().then(function(n){n.data.isScheduled?this.createNotificationSuccess({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.success")}):"SYNCHRONIZATION_IS_ALREADY_RUNNING"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.is_running")}):"SYNCHRONIZATION_IS_ALREADY_SCHEDULED"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.is_scheduled")}):this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.failed")})}.bind(this)).catch(function(n){this.createNotificationError({message:this.$tc("klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.failed")})}.bind(this))},scheduleSubscribersSynchronization:function(){this.subscribersSynchronizationJobInteractor.scheduleSynchronization().then(function(n){n.data.isScheduled?this.createNotificationSuccess({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.success")}):"SYNCHRONIZATION_IS_ALREADY_RUNNING"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.is_running")}):"SYNCHRONIZATION_IS_ALREADY_SCHEDULED"===n.data.errorCode?this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.is_scheduled")}):this.createNotificationWarning({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.failed")})}.bind(this)).catch(function(){this.createNotificationError({message:this.$tc("klaviyo_integration_plugin.subscribers.schedule_synchronization.failed")})}.bind(this))},resetSubscribersSynchronizationState:function(){this.subscribersSynchronizationJobInteractor.resetSynchronizationState()},resetHistoricalEventsSynchronizationState:function(){this.historicalEventsJobInteractor.resetSynchronizationState()}}});var y=e("fzkF"),f=e.n(y);function v(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}Shopware.Component.override("sw-promotion-v2-list",{template:f.a,methods:{getExportUrl:function(){return Shopware.Context.api.apiPath+"/klaviyo/integration/promotion/export"}}});var g=function(){function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.httpClient=t,this.loginService=e,this.name="klaviyoHistoricalEventsSynchronizationApiService"}var t,e,i;return t=n,(e=[{key:"scheduleSynchronization",value:function(){var n=this.getHeaders();return this.httpClient.post("/klaviyo/integration/job/_action/historical-event-tracking/synchronization/schedule",{},{headers:n})}},{key:"getHeaders",value:function(){return{Accept:"application/json",Authorization:"Bearer ".concat(this.loginService.getToken()),"Content-Type":"application/json"}}}])&&v(t.prototype,e),i&&v(t,i),n}();function b(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}var S=function(){function n(t,e){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this.httpClient=t,this.loginService=e,this.name="klaviyoSubscribersSynchronizationApiService"}var t,e,i;return t=n,(e=[{key:"scheduleSynchronization",value:function(){var n=this.getHeaders();return this.httpClient.post("/klaviyo/integration/job/_action/subscribers/synchronization/schedule",{},{headers:n})}},{key:"getHeaders",value:function(){return{Accept:"application/json",Authorization:"Bearer ".concat(this.loginService.getToken()),"Content-Type":"application/json"}}}])&&b(t.prototype,e),i&&b(t,i),n}();Shopware.Service().register("klaviyoHistoricalEventsSynchronizationApiService",(function(n){var t=Shopware.Application.getContainer("init");return new g(t.httpClient,n.loginService)})),Shopware.Service().register("klaviyoSubscribersSynchronizationApiService",(function(n){var t=Shopware.Application.getContainer("init");return new S(t.httpClient,n.loginService)}));var _=e("pJGq"),m=e.n(_),z=e("rZjl"),k=e.n(z),w=e("EU/g"),N=e.n(w);Shopware.Service("exportTemplateService").registerProductExportTemplate({name:"klaviyo-product-feed",translationKey:"klaviyo_integration_plugin.productComparison.templates.template-label.klaviyo-product-feed",headerTemplate:m.a.trim(),bodyTemplate:k.a,footerTemplate:N.a.trim(),fileName:"klaviyo.xml",encoding:"UTF-8",fileFormat:"xml",generateByCronjob:!1,interval:86400})},fzkF:function(n,t){n.exports='{% block sw_promotion_v2_list_smart_bar_actions_add %}\n    {% parent %}\n    <sw-button\n            :link="getExportUrl()"\n            variant="primary"\n    >\n        {{ $tc(\'klaviyo_integration_plugin.promotion.exportInKlaviyoFormatButtonLabel\') }}\n    </sw-button>\n{% endblock %}\n\n{% parent %}'},jumV:function(n,t){n.exports='<div class="klaviyo-historical-events-synchronization-control-wrapper">\n    <sw-card hero="true">\n        <sw-container columns="1fr 1fr">\n            <sw-card-section>\n                <sw-button-process variant="ghost"\n                                   :isLoading="historicalEventsJobInteractor.isSynchronizationInProgress"\n                                   :processSuccess="historicalEventsJobInteractor.isSynchronizationSuccess"\n                                   @click="scheduleHistoricalEventsSynchronization"\n                                   @process-finish="resetHistoricalEventsSynchronizationState"\n                >\n                    {{ $tc(\'klaviyo_integration_plugin.historical_events_tracking.schedule_synchronization.button_label\') }}\n                </sw-button-process>\n            </sw-card-section>\n            <sw-card-section>\n                <sw-button-process variant="ghost"\n                                   :isLoading="subscribersSynchronizationJobInteractor.isSynchronizationInProgress"\n                                   :processSuccess="subscribersSynchronizationJobInteractor.isSynchronizationSuccess"\n                                   @click="scheduleSubscribersSynchronization"\n                                   @process-finish="resetSubscribersSynchronizationState"\n                >\n                    {{ $tc(\'klaviyo_integration_plugin.subscribers.schedule_synchronization.button_label\') }}\n                </sw-button-process>\n            </sw-card-section>\n        </sw-container>\n    </sw-card>\n</div>\n'},ka2J:function(n,t,e){var i=e("UrNF");"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);(0,e("SZ7m").default)("1c5d7471",i,!0,{})},pIgR:function(n,t){n.exports="{% block sw_system_config_content_card %}\n    <klaviyo-historical-events-synchronization-control v-if=\"domain==='KlaviyoIntegrationPlugin.config'\">\n    </klaviyo-historical-events-synchronization-control>\n    {% parent %}\n{% endblock %}\n\n{% parent %}\n"},pJGq:function(n,t){n.exports='<?xml version="1.0" encoding="UTF-8" ?>\n<rss version="2.0" xmlns:g="http://base.google.com/ns/1.0" xmlns:atom="http://www.w3.org/2005/Atom">\n    <Products>\n'},rZjl:function(n,t){n.exports="<Product>\n    <id>{{ product.productNumber }}</id>\n    <title>{{ product.translated.name|escape }}</title>\n    <link>{{ seoUrl('frontend.detail.page', {'productId': product.id}) }}</link>\n    <description>{{ product.translated.description|escape }}</description>\n    <price>{% set price = product.calculatedPrice %} {% if product.calculatedPrices.count %} {% set price = product.calculatedPrices.last %} {% endif %} {{ price.unitPrice }}</price>\n    <image_link>{{ product.cover.media.url }}</image_link>\n    {%- if product.categories|length > 0 -%}\n        {% set categoryNames = [] %}\n\n        {% for category in product.categories %}\n            {% set categoryNames = categoryNames|merge([category.translated.name]) %}\n        {% endfor %}\n        <categories>{{ categoryNames|join(',')|raw|escape }}</categories>\n    {%- else -%}\n        <categories>n/a</categories>\n    {%- endif -%}\n    <inventory_quantity>{{ product.availableStock }}</inventory_quantity>\n    <inventory_policy>1</inventory_policy>\n</Product>\n"}});